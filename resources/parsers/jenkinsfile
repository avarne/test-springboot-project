pipeline
{
	agent 
	    {
	        label 'master'
	    }          
	/*{
		docker
			{
				image 'ibm_pilot:1'
				label 'master'
				args "-u 0 -v /data/ibm_jenkins_data/workspace/TestingPipeline/jenkins:/data/jenkins -e 'TZ=Asia/Kolkata'"
			}
	}*/

	stages
		{
			stage('Clone repo')
				{
					steps
						{
							echo "git clone repo"
							sh "resources/test.sh"  /*https://SuneelDigite:%24Plash919798@github.com/CAS-IBM/spring-boot-mvn-courses.git*/
						}
				}

			stage('Run Maven Junit')
				{
					steps
						{
							echo "execute junit"
							sh "cd /data/spring-boot-mvn-courses && mvn clean test"
						}

				}

			stage('Run Sonar')
				{	
					steps
						{
							echo "execute Sonar"
							sh "cd /data/spring-boot-mvn-courses && mvn sonar:sonar -Dsonar.projectKey=spring-boot-mvn-courses -Dsonar.host.url=https://ibm-sonar.digite.com -Dsonar.login=7a0da1e648e56a6bfce26777c747b5cf6e0320e4"
						}
				}

			stage('Create Artifact')
				{
					steps
						{
							echo "Create Artifact"
							sh "cd /data/spring-boot-mvn-courses && mvn clean install"
						}
				}		
		}
}
